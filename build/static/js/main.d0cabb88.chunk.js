(this.webpackJsonpminipainter3d=this.webpackJsonpminipainter3d||[]).push([[0],{102:function(e,t,a){e.exports=a(115)},115:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(45),i=a.n(o),l=a(11),c=a(18),s=a(149),u=a(150),d=a(146),m=a(23),p=a(70),g=a(151),b=a(12),f=a(148),h=Object(f.a)((function(e){return{menuWrapper:{display:"flex",width:"100%",flexDirection:"row",boxShadow:"0 2px 10px rgba(0,0,0,0.1)"},primaryMenuWrapper:{display:"flex",width:"100%",flexDirection:"row",alignItems:"flex-start",justifyContent:"flex-start",borderBottom:"1px solid rgba(255,255,255,0.1)",zIndex:1,height:67},divider:{width:"100%",marginTop:10},dividerWithLine:{width:"100%",marginTop:10,paddingBottom:10,borderTop:"1px solid #eee"},desktop:{display:"flex",flexDirection:"column"},mobile:{width:"100%"},grid:{display:"grid",width:"100%"},title:{fontWeight:"bold"}}})),y=a(147),v=a(40);function k(e){var t,a=e.children,n=e.a,o=e.j,i=e.w,l=e.p,c=e.b,s=e.br,u=e.h,d=e.bg,m=e.m,p=e.mw,g=e.classAdd,f=e.onClickEvent,y=e.bb,k=e.of,x=e.mh,E=n||"center",j=i||"100%",w=p||"100%",O=x||"100%",I=u||"",C=o||"center",S=l||0,P=c||"none",A=d||"",B=s||0,z=y||0,T=m||0,M=k||"",D=h();return r.a.createElement("div",{style:{width:j,alignItems:E,justifyContent:C,padding:S,border:P,borderRadius:B,boxSizing:"border-box",height:I,background:A,margin:T,maxWidth:w,borderBottom:z,overflow:M,maxHeight:O},className:Object(v.a)((t={},Object(b.a)(t,D.desktop,!0),Object(b.a)(t,g,g),Object(b.a)(t,D.primaryBack,"primary"===A),Object(b.a)(t,D.secondaryBack,"secondary"===A),t)),onClick:f||null},a)}function x(e){var t=e.children,a=e.a,n=e.j,o=e.wrap,i=e.w,l=e.b,c=e.pb,s=e.pt,u=e.pl,d=e.pr,m=e.v,p=e.mb,g=e.mt,b=e.mr,f=e.mw,h=e.br,y=e.bg,v=e.h,k=e.o,x=e.of,E=e.bb,j=e.className,w=e.onClickEvent,O=a||"center",I=n||"center",C=i||"100%",S=l||"",P=c||"",A=s||"",B=u||"",z=d||"",T=p||"",M=b||"",D=g||"",F=h||"",R=y||"",L=v||"",W=k||"",_=x||"",N=f||"",Z=E||"";return"none"===m?null:r.a.createElement("div",{style:{display:"flex",width:C,flexDirection:"row",alignItems:O,justifyContent:I,flexWrap:o,border:S,paddingBottom:P,paddingLeft:B,paddingRight:z,paddingTop:A,marginBottom:T,marginTop:D,marginRight:M,borderRadius:F,background:R,height:L,opacity:W,overflow:_,maxWidth:N,boxSizing:"border-box",borderBottom:Z,cursor:w?"pointer":"default"},className:j||null,onClick:function(){return w?w():null}},t)}var E=a(27),j=a(152),w=a(13),O=a(3);function I(e){var t=e.geometry,a=e.name,o=e.decalNormal,i=e.decals,c=e.position,s=e.rotation,u=e.scale,d=e.activeColor,m=e.texture,p=e.materialIn,g=e.shading,b=e.paint,f=e.setTargetA,h=(e.buttons,e.clickEvent),y=e.fullColor,v=r.a.useState(null),k=Object(l.a)(v,2),x=k[0],E=k[1],j=r.a.useState("#fff"),I=Object(l.a)(j,2),C=I[0],S=I[1],P=r.a.useState(0),A=Object(l.a)(P,2),B=A[0],z=A[1];return Object(n.useEffect)((function(){if(null!==b){var e=JSON.parse(b);e[a]&&S(e[a].color)}if(!x&&!m){var t=new O.MeshStandardMaterial(Object(w.a)(Object(w.a)({},p),{},{transparent:!0}));E(t)}""!==y.name&&-1===a.indexOf("noshade")&&S(y.color)}),[o,i,C,x,p,b,a,m,y]),x?r.a.createElement("group",{position:c&&c,rotation:s&&s,scale:u&&u},r.a.createElement("mesh",{onPointerDown:function(e){return 1!==B&&z(1)},onPointerUp:function(e){if(e.stopPropagation(),h(a,C),f({target:"".concat(c[0],",").concat(c[1]-7,",").concat(c[2])}),1===B&&"Shade"!==d.type){var t=localStorage.getItem("modelColorSave");t="null"===t||null===t?{}:JSON.parse(t),d&&(t[a]={color:d.color,name:d.name},localStorage.setItem("modelColorSave",JSON.stringify(t)),S(d.color))}},onPointerMove:function(e){return 0!==B&&!g&&z(0)},geometry:t,material:x,"material-color":C,"material-metalness":0,"material-roughness":.8})):null}function C(e){var t=e.gltfIn,a=e.activeColor,o=e.sprayMode,i=e.paint,l=e.setTargetA,c=e.buttons,s=e.targetA,u=e.clickEvent,d=e.fullColor,m=Object(n.useRef)(),p=Object(j.a)(t).nodes,g=function(e){return parseFloat(e.toFixed(Math.round(2)))},b=function(e){for(var t=Math.abs(Math.round(1e5*parseFloat(e))),a=1;a<=10;a++)if(t===Math.round(1e5*parseFloat(Math.PI/a)))return Math.PI/2;return g(e)},f=[];var h=Object.values(p);return r.a.createElement("group",{ref:m,dispose:null},function e(t){var n=[];if(t)for(var m=0;m<t.length;m++){var p=t[m];p.scale&&p.scale.isVector3&&(1!==g(p.scale.x)||1!==g(p.scale.y)||g(p.scale.z));var h=Object.values(p.children);-1===f.indexOf(p.name)&&(f.push(p.name),p.geometry&&p.visible&&n.push(r.a.createElement("group",{dispose:null},r.a.createElement(I,{clickEvent:u,sprayMode:o,activeColor:a,fullColor:d,geometry:p.geometry,scale:p.scale,materialIn:t[m].material,setTargetA:l,targetA:s,buttons:c,paint:i,decals:null,video:null,name:p.name,position:[g(p.position.x),g(p.position.y),g(p.position.z)],rotation:[b(p.rotation.x),b(p.rotation.y),b(p.rotation.z)]},e(h)))),"Object3D"===p.type&&n.push(r.a.createElement("group",{position:[g(p.position.x),g(p.position.y),g(p.position.z)],scale:p.scale,rotation:[b(p.rotation.x),b(p.rotation.y),b(p.rotation.z)]},e(h))))}return n.filter((function(e){return null!==e}))}(h))}var S=a(140),P=a(141),A=Object(f.a)((function(e){return{menuWrapper:{display:"flex",width:"100%",flexDirection:"row",boxShadow:"0 2px 10px rgba(0,0,0,0.1)"},primaryMenuWrapper:{display:"flex",width:"100%",flexDirection:"row",alignItems:"flex-start",justifyContent:"flex-start",borderBottom:"1px solid rgba(255,255,255,0.1)",zIndex:1,height:67},desktop:{display:"flex",flexDirection:"column"},mobile:{width:"100%"},grid:{display:"grid",width:"100%"},title:{fontWeight:"bold"}}})),B=a(153);function z(e){var t,a=e.children,n=e.a,o=e.j,i=e.w,l=e.p,c=e.b,s=e.br,u=e.h,d=e.bg,m=e.m,p=e.mw,g=e.classAdd,f=e.onClickEvent,h=n||"center",y=i||"100%",k=p||"100%",x=u||"",E=o||"center",j=l||0,w=c||"none",O=d||"",I=s||0,C=m||0,S=A(),P=Object(B.a)("(max-width:600px)");return r.a.createElement("div",{style:{width:!P&&y,alignItems:h,justifyContent:E,padding:j,border:w,borderRadius:I,boxSizing:"border-box",height:x,background:O,margin:C,maxWidth:k},className:Object(v.a)((t={},Object(b.a)(t,S.desktop,!0),Object(b.a)(t,S.mobile,P),Object(b.a)(t,g,g),Object(b.a)(t,S.primaryBack,"primary"===O),Object(b.a)(t,S.secondaryBack,"secondary"===O),t)),onClick:f||null},a)}function T(e){var t=e.children,a=e.a,n=e.j,o=e.wrap,i=e.w,l=e.b,c=e.pb,s=e.pt,u=e.pl,d=e.pr,m=e.v,p=e.mb,g=e.mt,b=e.mr,f=e.mw,h=e.br,y=e.bg,v=e.h,k=e.o,x=e.of,E=e.className,j=e.onClickEvent,w=a||"center",O=n||"center",I=i||"100%",C=l||"",S=c||"",P=s||"",A=u||"",B=d||"",z=p||"",T=b||"",M=g||"",D=h||"",F=y||"",R=v||"",L=k||"",W=x||"",_=f||"";return"none"===m?null:r.a.createElement("div",{style:{display:"flex",width:I,flexDirection:"row",alignItems:w,justifyContent:O,flexWrap:o,border:C,paddingBottom:S,paddingLeft:A,paddingRight:B,paddingTop:P,marginBottom:z,marginTop:M,marginRight:T,borderRadius:D,background:F,height:R,opacity:L,overflow:W,maxWidth:_,boxSizing:"border-box"},className:E||null,onClick:function(){return j?j():null}},t)}var M=a(52),D=a(90),F=function(e,t,a,n){var r=a.position,o=a.target,i=a.duration,l=a.minDistance;t.enabled=!1;var c={},s={};return r&&(c.px=e.position.x,c.py=e.position.y,c.pz=e.position.z,s.px=r.x,s.py=r.y,s.pz=r.z),o&&(c.tx=t.target.x,c.ty=t.target.y,c.tz=t.target.z,s.tx=o.x,s.ty=o.y,s.tz=o.z),new M.a.Tween(c).to(s,null!==i&&void 0!==i?i:5e3).easing(M.a.Easing.Sinusoidal.InOut).onUpdate((function(a){var n=a.px,r=a.py,o=a.pz,i=a.tx,c=a.ty,s=a.tz;null!=n&&e.position.set(n,r,o),null!=i&&t.target.set(i,c,s),null!=l&&(t.minDistance=100)})).onComplete((function(){t.enabled=!0,n&&n()})).start()};Object(E.b)({OrbitControls:D.a});var R=Object(n.memo)((function(e){var t=e.target,a=(e.setTargetA,e.rotate),o=e.enablePan,i=e.enableZoom,c=Object(n.useRef)(),s=Object(E.e)(),u=s.camera,d=s.gl.domElement,m=Object(n.useCallback)((function(e){var t=e.camera,a=e.target,n=e.fov;if(t&&a&&c&&n){var r=Object(l.a)(t,3),o=r[0],i=r[1],s=r[2],d=Object(l.a)(a,3),m=d[0],p=d[1],g=d[2];F(u,c.current,{position:{x:o,y:i,z:s},target:{x:m,y:p,z:g},duration:1e3},(function(){}))}}),[u]);return Object(n.useEffect)((function(){m({target:t.target,camera:t.position,fov:30})}),[m,t]),Object(E.c)((function(e){e.clock,e.camera;M.a.update(),c.current.update()})),r.a.createElement(r.a.Fragment,null,r.a.createElement("orbitControls",{minPan:new O.Vector3(0,0,0),manPan:new O.Vector3(0,0,0),enableZoom:"false"!==i,enablePan:"false"!==o,enableDamping:!0,autoRotate:"false"!==a,autoRotateSpeed:10,ref:c,args:[u,d]}))}));function L(e){var t=e.color,a=e.setActiveColor;return r.a.createElement("button",{style:{background:t,maxWidth:"20px",minWidth:"20px",maxHeight:"20px",minHeight:"20px",border:"none",margin:5,boxShadow:"2px 2px 5px rgba(0,0,0,0.3)"},onClick:function(){return a({name:t,color:t})}})}function W(){var e=Object(S.a)().progress;return r.a.createElement(P.a,{center:!0,style:{whiteSpace:"nowrap",color:"#222",fontFamily:"arial"}},"Loading ".concat(e.toString().substring(0,2),"%, please wait!"))}function _(){return r.a.createElement(P.a,{center:!0,style:{color:"rgba(0,0,0,0.2)",fontFamily:"arial",fontSize:"1rem"}},"https://minipainter3d.herokuapp.com")}function N(e){var t=e.sprayMode,a=e.gltfIn,o=e.lightTwo,i=e.lightThree,c=e.lightFour,s=e.lightFive,u=e.lightSix,d=e.lightSeven,m=e.markings,p=e.rotate,g=e.paint,b=e.cameraPos,f=e.targets,h=e.watermark,v=e.clickEvent,k=e.enablePan,x=e.enableZoom,j=e.suspenseImage,w=e.backgroundColor,O=e.clickFor3d,I=e.colors,P=r.a.useState({target:[],position:[]}),A=Object(l.a)(P,2),B=A[0],M=A[1],D=r.a.useState(!1),F=Object(l.a)(D,2),N=F[0],Z=F[1],q=r.a.useState({name:"",color:""}),$=Object(l.a)(q,2),G=$[0],J=($[1],r.a.useState({name:"",color:""})),H=Object(l.a)(J,2),V=H[0],U=H[1],K=Object(n.useRef)(null);Object(n.useEffect)((function(){M({target:[1*f.split(",")[0],1*f.split(",")[1],1*f.split(",")[2]],position:b}),U({name:I.split(",")[0],color:I.split(",")[0]})}),[f,b,I]);var Q=Object(S.a)().progress;return console.log(O,N),O&&!N?r.a.createElement("div",{style:{position:"relative",width:"100%",height:"100%",backgroundImage:"url(".concat(j,")"),backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"center",display:"flex",alignItems:"center",justifyContent:"center"},onClick:function(){!N&&Z(!0)}},r.a.createElement(y.a,{style:{color:w||"#fff",opacity:1,textShadow:"3px 3px 5px rgba(0,0,0,1)",fontSize:"3rem",fontWeight:"bold"}},"Click for 3D")):r.a.createElement("div",{style:{position:"relative",width:"100%",height:"100%",backgroundImage:"url(".concat(j,")"),backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"center"}},r.a.createElement(z,{h:"100%",w:"100%"},r.a.createElement(T,{w:"100%",h:"100%"},r.a.createElement(E.a,{pixelRatio:[1,2],camera:{position:B.position,fov:10,far:700},ref:K,gl:{preserveDrawingBuffer:!0},style:{height:"100%",width:"100%",backgroundColor:w||"none",opacity:Q/100}},r.a.createElement(n.Suspense,{fallback:r.a.createElement(W,null)},r.a.createElement("group",{name:"sun",position:[500,900,0]},r.a.createElement("ambientLight",{intensity:.2})),r.a.createElement("group",{name:"sun",position:[50,0,0]},r.a.createElement("spotLight",{intensity:o/50})),r.a.createElement("group",{name:"sun",position:[-50,0,0]},r.a.createElement("spotLight",{intensity:i/50})),r.a.createElement("group",{name:"sun",position:[0,50,0]},r.a.createElement("spotLight",{intensity:c/50})),r.a.createElement("group",{name:"sun",position:[0,-50,0]},r.a.createElement("spotLight",{intensity:s/50})),r.a.createElement("group",{name:"sun",position:[0,0,50]},r.a.createElement("spotLight",{intensity:u/50})),r.a.createElement("group",{name:"sun",position:[0,0,-50]},r.a.createElement("spotLight",{intensity:d/50})),r.a.createElement("group",{position:[0,-20,0]},h&&r.a.createElement(_,null)),r.a.createElement("group",{position:[0,-8,0]},r.a.createElement(C,{activeColor:G,fullColor:V,sprayMode:t,gltfIn:a,markings:m,armourColor:null,shading:!1,paint:g,setTargetA:M,targetA:B,buttons:["ScreenTwo","ScreenThree003"],clickEvent:v}))),r.a.createElement(R,{target:B,setTargetA:M,rotate:p,enablePan:k,enableZoom:x}))),r.a.createElement(T,null,I&&I.split(",").map((function(e){return r.a.createElement(L,{color:e,setActiveColor:U})})))))}var Z,q,$,G=Object(c.f)((function(e){var t=e.gltf,a=e.js,o=e.gameId,i=e.box,c=e.back,s=e.game,u=e.login,d=e.history,m=e.profilePriority,p=e.modelArtist,g=e.controls,b=e.rotate,f=e.paint,h=e.cameraPos,y=e.targets,v=e.watermark,E=e.clickEvent,j=e.enableZoom,w=e.enablePan,O=e.suspenseImage,I=e.backgroundColor,C=e.clickFor3d,S=e.colors,P=Object(n.useRef)({}),A=r.a.useState(null),B=Object(l.a)(A,2),z=B[0],T=B[1],M=r.a.useState(0),D=Object(l.a)(M,2),F=D[0],R=D[1],L=r.a.useState(null),W=Object(l.a)(L,2),_=W[0],Z=W[1],q={};return Object(n.useEffect)((function(){!_&&Z(q)}),[q,_,P,a]),r.a.createElement(k,{h:"100%",w:"100%"},r.a.createElement(x,{h:"100%",w:"100%",j:"flex-start",a:"flex-start"},r.a.createElement(N,{activeColor:{color:"#fff",name:"Plastic Grey"},sprayMode:!1,gltfIn:t,gameId:o,modelName:s,paintMode:F,setPaintMode:R,lightOne:30,lightTwo:30,lightThree:0,lightFour:30,lightFive:0,lightSix:0,lightSeven:0,box:i,setPanels:T,panels:z,back:c,login:u,history:d,markings:null,profilePriority:m,modelArtist:p||null,rotate:b,controls:g,paint:f,cameraPos:h,targets:y,watermark:v,clickEvent:E,enablePan:w,enableZoom:j,suspenseImage:O,backgroundColor:I,clickFor3d:C,colors:S})))})),J=a(71),H=["basic","modelId","controls","rotate","paint","cameraPos","targets","url","userId","clickEvent","enablePan","enableZoom","suspenseImage","backgroundColor","clickFor3d","colors"],V=Object(J.a)(Z||(Z=Object(p.a)(["\n  query gameById($_id: MongoID!) {\n    gameById(_id: $_id) {\n      _id\n      name\n      summary\n      featureImage\n      gltf\n      bin\n      js\n      url\n      price\n      artistLink\n      artistName\n      whereToBuyLink\n      user {\n        _id\n        name\n        profileImg\n      }\n    }\n  }\n"]))),U=Object(J.a)(q||(q=Object(p.a)(["\n  query savedGameById($_id: MongoID!) {\n    savedGameById(_id: $_id) {\n      saveDataColors\n    }\n  }\n"]))),K=Object(J.a)($||($=Object(p.a)(["\n  query userById($_id: MongoID!) {\n    userById(_id: $_id) {\n      priority\n      name\n    }\n  }\n"])));function Q(e){e.basic;var t=e.modelId,a=e.controls,o=e.rotate,i=e.paint,c=e.cameraPos,s=e.targets,u=e.url,d=e.userId,p=e.clickEvent,b=e.enablePan,f=e.enableZoom,h=e.suspenseImage,y=e.backgroundColor,v=e.clickFor3d,k=e.colors,x=Object(m.a)(e,H),E=r.a.useState(null),j=Object(l.a)(E,2),w=j[0],O=j[1],I=r.a.useState(null),C=Object(l.a)(I,2),S=C[0],P=C[1],A=r.a.useState(null),B=Object(l.a)(A,2),z=B[0],T=B[1],M=r.a.useState(null),D=Object(l.a)(M,2),F=D[0],R=D[1];return Object(n.useEffect)((function(){T(t)}),[t]),r.a.createElement("div",{style:{height:"100%",width:"100%"},onClick:function(){return i=null}},r.a.createElement("div",{style:{height:"100%",width:"100%"}},(w||u)&&r.a.createElement(G,{gltf:u||w.gltf,js:u?"Model":w.js,parts:null,gameId:u?null:w._id,box:null,game:u?{}:w,login:!0,history:x.history,controls:a,rotate:o,cameraPos:c,paint:S,targets:s,clickEvent:p,enablePan:b,enableZoom:f,suspenseImage:h,backgroundColor:y,clickFor3d:v,colors:k,watermark:!(F&&(!F||0===F.priority)),modelArtist:u?{}:{name:w.artistName,link:w.artistLink,buyLink:w.whereToBuyLink}})),!F&&d&&w&&r.a.createElement(g.a,{query:K,variables:{_id:d},fetchPolicy:"network-only",onCompleted:function(e){R(e.userById)}},(function(e){e.data;return null})),i&&w&&!S&&r.a.createElement(g.a,{query:U,variables:{_id:i},fetchPolicy:"network-only",onCompleted:function(e){P(e.savedGameById.saveDataColors)}},(function(e){e.data;return null})),i&&w&&!S&&r.a.createElement(g.a,{query:U,variables:{_id:i},fetchPolicy:"network-only",onCompleted:function(e){P(e.savedGameById.saveDataColors)}},(function(e){e.data;return null})),!w&&!u&&r.a.createElement(g.a,{query:V,variables:{_id:z},fetchPolicy:"network-only",onCompleted:function(e){return O(e.gameById)}},(function(e){e.data;return e.error?"Please visit http://minipainter3d.herokuapp.com":null})))}function X(e){var t=e.theme,a=e.modelId,n=e.controls,o=e.rotate,i=e.paint,l=e.cameraPos,s=e.targets,u=e.url,d=e.userId,m=e.clickEvent,p=e.enableZoom,g=e.enablePan,b=e.suspenseImage,f=e.backgroundColor,h=e.clickFor3d,y=e.colors;Object.assign({},e.props);return r.a.createElement(c.c,null,r.a.createElement(c.a,{path:"/",render:function(e){return r.a.createElement(Q,Object.assign({},e,{theme:t,basic:!0,modelId:a,controls:n,rotate:o,paint:i,cameraPos:l,targets:s,url:u,userId:d,clickEvent:m,enablePan:g,enableZoom:p,suspenseImage:b,backgroundColor:f,clickFor3d:h,colors:y}))}}))}for(var Y=Object(c.f)((function(e){var t=new s.a({uri:"https://minipainter3d-api.herokuapp.com/graphql",cache:new u.a({addTypename:!1}),headers:{authorization:""}}),a=r.a.useState(null),o=Object(l.a)(a,2),i=o[0],c=o[1],m=r.a.useState(!1),p=Object(l.a)(m,2),g=p[0],b=p[1];Object(n.useEffect)((function(){c(e.elementId),"true"===document.getElementById(e.elementId).getAttribute("clickfor3d")&&b(!0)}),[e]);var f=document.getElementById(i);if(f){var h=f.getAttribute("userId"),y=f.getAttribute("camera").split(","),v=f.getAttribute("modelid"),k=f.getAttribute("controls"),x=f.getAttribute("rotate"),E=f.getAttribute("paint"),j=f.getAttribute("url"),w=h,O=f.getAttribute("targets"),I=[y[0],y[1],y[2]],C=f.getAttribute("enablepan"),S=f.getAttribute("enablezoom"),P=f.getAttribute("suspenseimage"),A=f.getAttribute("backgroundcolor"),B=window[f.getAttribute("onclickevent")],z=f.getAttribute("colors");return r.a.createElement("div",{style:{width:"100%",height:"100%"}},r.a.createElement(d.a,{client:t},v?r.a.createElement(X,{props:e,theme:null,modelId:v,controls:k,rotate:x,paint:E,cameraPos:I,targets:O,url:j,userId:w,clickEvent:B,enablePan:C,enableZoom:S,suspenseImage:P,backgroundColor:A,clickFor3d:g,colors:z}):'Please add this to your site: <div id="modelId" modelId="6259ae1fb012e3b1d9746402"></div>'))}return null})),ee=a(49),te=[],ae=document.getElementsByTagName("div"),ne=0;ne<ae.length;ne++)ae[ne].id.indexOf("modelId")>-1&&te.push(ae[ne].id);te.map((function(e){return i.a.render(r.a.createElement(ee.a,null,r.a.createElement(Y,{elementId:e})),document.getElementById(e))}))}},[[102,1,2]]]);
//# sourceMappingURL=main.d0cabb88.chunk.js.map