(this.webpackJsonpminipainter3d=this.webpackJsonpminipainter3d||[]).push([[0],{102:function(e,t,a){e.exports=a(115)},115:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(45),i=a.n(o),l=a(11),c=a(18),s=a(149),u=a(150),d=a(146),m=a(23),p=a(70),g=a(151),b=a(12),f=a(148),h=Object(f.a)((function(e){return{menuWrapper:{display:"flex",width:"100%",flexDirection:"row",boxShadow:"0 2px 10px rgba(0,0,0,0.1)"},primaryMenuWrapper:{display:"flex",width:"100%",flexDirection:"row",alignItems:"flex-start",justifyContent:"flex-start",borderBottom:"1px solid rgba(255,255,255,0.1)",zIndex:1,height:67},divider:{width:"100%",marginTop:10},dividerWithLine:{width:"100%",marginTop:10,paddingBottom:10,borderTop:"1px solid #eee"},desktop:{display:"flex",flexDirection:"column"},mobile:{width:"100%"},grid:{display:"grid",width:"100%"},title:{fontWeight:"bold"}}})),y=(a(147),a(40));function v(e){var t,a=e.children,n=e.a,o=e.j,i=e.w,l=e.p,c=e.b,s=e.br,u=e.h,d=e.bg,m=e.m,p=e.mw,g=e.classAdd,f=e.onClickEvent,v=e.bb,j=e.of,x=e.mh,O=n||"center",w=i||"100%",E=p||"100%",k=x||"100%",I=u||"",S=o||"center",C=l||0,B=c||"none",P=d||"",z=s||0,T=v||0,A=m||0,M=j||"",D=h();return r.a.createElement("div",{style:{width:w,alignItems:O,justifyContent:S,padding:C,border:B,borderRadius:z,boxSizing:"border-box",height:I,background:P,margin:A,maxWidth:E,borderBottom:T,overflow:M,maxHeight:k},className:Object(y.a)((t={},Object(b.a)(t,D.desktop,!0),Object(b.a)(t,g,g),Object(b.a)(t,D.primaryBack,"primary"===P),Object(b.a)(t,D.secondaryBack,"secondary"===P),t)),onClick:f||null},a)}function j(e){var t=e.children,a=e.a,n=e.j,o=e.wrap,i=e.w,l=e.b,c=e.pb,s=e.pt,u=e.pl,d=e.pr,m=e.v,p=e.mb,g=e.mt,b=e.mr,f=e.mw,h=e.br,y=e.bg,v=e.h,j=e.o,x=e.of,O=e.bb,w=e.className,E=e.onClickEvent,k=a||"center",I=n||"center",S=i||"100%",C=l||"",B=c||"",P=s||"",z=u||"",T=d||"",A=p||"",M=b||"",D=g||"",L=h||"",R=y||"",_=v||"",N=j||"",W=x||"",F=f||"",q=O||"";return"none"===m?null:r.a.createElement("div",{style:{display:"flex",width:S,flexDirection:"row",alignItems:k,justifyContent:I,flexWrap:o,border:C,paddingBottom:B,paddingLeft:z,paddingRight:T,paddingTop:P,marginBottom:A,marginTop:D,marginRight:M,borderRadius:L,background:R,height:_,opacity:N,overflow:W,maxWidth:F,boxSizing:"border-box",borderBottom:q,cursor:E?"pointer":"default"},className:w||null,onClick:function(){return E?E():null}},t)}var x=a(27),O=a(152),w=a(13),E=a(3);function k(e){var t=e.geometry,a=e.name,o=e.decalNormal,i=e.decals,c=e.position,s=e.rotation,u=e.scale,d=e.activeColor,m=e.texture,p=e.materialIn,g=e.shading,b=e.paint,f=e.setTargetA,h=e.buttons,y=r.a.useState(null),v=Object(l.a)(y,2),j=v[0],x=v[1],O=r.a.useState("#fff"),k=Object(l.a)(O,2),I=k[0],S=k[1],C=r.a.useState(0),B=Object(l.a)(C,2),P=B[0],z=B[1];return Object(n.useEffect)((function(){if(null!==b){var e=JSON.parse(b);e[a]&&S(e[a].color)}if(!j&&!m){var t=new E.MeshStandardMaterial(Object(w.a)(Object(w.a)({},p),{},{transparent:!0}));x(t)}}),[o,i,I,j,p,b,a,m]),j?r.a.createElement("group",{position:c&&c,rotation:s&&s,scale:u&&u},r.a.createElement("mesh",{onClick:function(e){},onPointerDown:function(e){return 1!==P&&z(1)},onPointerUp:function(e){if(1===P&&(h.indexOf(a)>-1?f({position:[-30,0,100],target:[c[0],c[1]-7,c[2]]}):f({position:[0,0,400],target:[0,0,0]}),"Shade"!==d.type)){e.stopPropagation();var t=localStorage.getItem("modelColorSave");t="null"===t||null===t?{}:JSON.parse(t),d&&(t[a]={color:d.color,name:d.name},localStorage.setItem("modelColorSave",JSON.stringify(t)),S(d.color))}},onPointerMove:function(e){return 0!==P&&!g&&z(0)},geometry:t,material:j,"material-color":I,"material-metalness":0,"material-roughness":0})):null}function I(e){var t=e.gltfIn,a=e.activeColor,o=e.sprayMode,i=e.paint,l=e.setTargetA,c=e.buttons,s=e.targetA,u=Object(n.useRef)(),d=Object(O.a)(t).nodes,m=function(e){return parseFloat(e.toFixed(Math.round(2)))},p=function(e){for(var t=Math.abs(Math.round(1e5*parseFloat(e))),a=1;a<=10;a++)if(t===Math.round(1e5*parseFloat(Math.PI/a)))return Math.PI/2;return m(e)},g=[];var b=Object.values(d);return r.a.createElement("group",{ref:u,dispose:null},function e(t){var n=[];if(t)for(var u=0;u<t.length;u++){var d=t[u];d.scale&&d.scale.isVector3&&(1!==m(d.scale.x)||1!==m(d.scale.y)||m(d.scale.z));var b=Object.values(d.children);-1===g.indexOf(d.name)&&(g.push(d.name),d.geometry&&d.visible&&n.push(r.a.createElement("group",{dispose:null},r.a.createElement(k,{sprayMode:o,activeColor:a,geometry:d.geometry,scale:d.scale,materialIn:t[u].material,setTargetA:l,targetA:s,buttons:c,paint:i,decals:null,video:null,name:d.name,position:[m(d.position.x),m(d.position.y),m(d.position.z)],rotation:[p(d.rotation.x),p(d.rotation.y),p(d.rotation.z)]},e(b)))),"Object3D"===d.type&&n.push(r.a.createElement("group",{position:[m(d.position.x),m(d.position.y),m(d.position.z)],scale:d.scale,rotation:[p(d.rotation.x),p(d.rotation.y),p(d.rotation.z)]},e(b))))}return n.filter((function(e){return null!==e}))}(b))}var S=a(140),C=a(141),B=Object(f.a)((function(e){return{menuWrapper:{display:"flex",width:"100%",flexDirection:"row",boxShadow:"0 2px 10px rgba(0,0,0,0.1)"},primaryMenuWrapper:{display:"flex",width:"100%",flexDirection:"row",alignItems:"flex-start",justifyContent:"flex-start",borderBottom:"1px solid rgba(255,255,255,0.1)",zIndex:1,height:67},desktop:{display:"flex",flexDirection:"column"},mobile:{width:"100%"},grid:{display:"grid",width:"100%"},title:{fontWeight:"bold"}}})),P=a(153);function z(e){var t,a=e.children,n=e.a,o=e.j,i=e.w,l=e.p,c=e.b,s=e.br,u=e.h,d=e.bg,m=e.m,p=e.mw,g=e.classAdd,f=e.onClickEvent,h=n||"center",v=i||"100%",j=p||"100%",x=u||"",O=o||"center",w=l||0,E=c||"none",k=d||"",I=s||0,S=m||0,C=B(),z=Object(P.a)("(max-width:600px)");return r.a.createElement("div",{style:{width:!z&&v,alignItems:h,justifyContent:O,padding:w,border:E,borderRadius:I,boxSizing:"border-box",height:x,background:k,margin:S,maxWidth:j},className:Object(y.a)((t={},Object(b.a)(t,C.desktop,!0),Object(b.a)(t,C.mobile,z),Object(b.a)(t,g,g),Object(b.a)(t,C.primaryBack,"primary"===k),Object(b.a)(t,C.secondaryBack,"secondary"===k),t)),onClick:f||null},a)}function T(e){var t=e.children,a=e.a,n=e.j,o=e.wrap,i=e.w,l=e.b,c=e.pb,s=e.pt,u=e.pl,d=e.pr,m=e.v,p=e.mb,g=e.mt,b=e.mr,f=e.mw,h=e.br,y=e.bg,v=e.h,j=e.o,x=e.of,O=e.className,w=e.onClickEvent,E=a||"center",k=n||"center",I=i||"100%",S=l||"",C=c||"",B=s||"",P=u||"",z=d||"",T=p||"",A=b||"",M=g||"",D=h||"",L=y||"",R=v||"",_=j||"",N=x||"",W=f||"";return"none"===m?null:r.a.createElement("div",{style:{display:"flex",width:I,flexDirection:"row",alignItems:E,justifyContent:k,flexWrap:o,border:S,paddingBottom:C,paddingLeft:P,paddingRight:z,paddingTop:B,marginBottom:T,marginTop:M,marginRight:A,borderRadius:D,background:L,height:R,opacity:_,overflow:N,maxWidth:W,boxSizing:"border-box"},className:O||null,onClick:function(){return w?w():null}},t)}var A=a(52),M=a(89),D=function(e,t,a,n){var r=a.position,o=a.target,i=a.duration,l=a.minDistance;t.enabled=!1;var c={},s={};return r&&(c.px=e.position.x,c.py=e.position.y,c.pz=e.position.z,s.px=r.x,s.py=r.y,s.pz=r.z),o&&(c.tx=t.target.x,c.ty=t.target.y,c.tz=t.target.z,s.tx=o.x,s.ty=o.y,s.tz=o.z),new A.a.Tween(c).to(s,null!==i&&void 0!==i?i:5e3).easing(A.a.Easing.Sinusoidal.InOut).onUpdate((function(a){var n=a.px,r=a.py,o=a.pz,i=a.tx,c=a.ty,s=a.tz;null!=n&&e.position.set(n,r,o),null!=i&&t.target.set(i,c,s),null!=l&&(t.minDistance=100)})).onComplete((function(){t.enabled=!0,n&&n()})).start()};Object(x.b)({OrbitControls:M.a});var L=Object(n.memo)((function(e){var t=e.target,a=(e.setTargetA,e.rotate),o=Object(n.useRef)(),i=Object(x.e)(),c=i.camera,s=i.gl.domElement,u=Object(n.useCallback)((function(e){var t=e.camera,a=e.target,n=e.fov;if(t&&a&&o&&n){var r=Object(l.a)(t,3),i=r[0],s=r[1],u=r[2],d=Object(l.a)(a,3),m=d[0],p=d[1],g=d[2];D(c,o.current,{position:{x:i,y:s,z:u},target:{x:m,y:p,z:g},duration:1e3},(function(){}))}}),[c]);return Object(n.useEffect)((function(){u({target:t.target,camera:t.position,fov:30})}),[u,t]),Object(x.c)((function(e){e.clock,e.camera;A.a.update(),o.current.update()})),r.a.createElement(r.a.Fragment,null,r.a.createElement("orbitControls",{minPan:new E.Vector3(0,0,0),manPan:new E.Vector3(0,0,0),enableZoom:!0,enablePan:!0,enableDamping:!0,autoRotate:a,autoRotateSpeed:10,ref:o,args:[c,s]}))}));function R(){var e=Object(S.a)().progress;return r.a.createElement(C.a,{center:!0,style:{whiteSpace:"nowrap",padding:15,borderRadius:3,color:"#222",opacity:e/100,fontFamily:"arial"}},"Loading ".concat(e.toString().substring(0,2),"%, please wait!"))}function _(){return r.a.createElement(C.a,{center:!0,style:{color:"rgba(0,0,0,0.2)",fontFamily:"arial",fontSize:"1rem"}},"https://minipainter3d.herokuapp.com")}function N(e){var t=e.activeColor,a=e.sprayMode,o=e.gltfIn,i=e.lightTwo,c=e.lightThree,s=e.lightFour,u=e.lightFive,d=e.lightSix,m=e.lightSeven,p=e.markings,g=e.rotate,b=e.paint,f=e.cameraPos,h=e.targets,y=e.watermark,v=r.a.useState({target:[],position:[]}),j=Object(l.a)(v,2),O=j[0],w=j[1],E=Object(n.useRef)(null);return Object(n.useEffect)((function(){w({target:[1*h.split(",")[0],1*h.split(",")[1],1*h.split(",")[2]],position:f})}),[h,f]),r.a.createElement("div",{style:{position:"relative",width:"100%",height:"100%"}},r.a.createElement(z,{h:"100%",w:"100%"},r.a.createElement(T,{w:"100%",h:"100%"},r.a.createElement(x.a,{pixelRatio:[1,2],camera:{position:O.position,fov:10,far:700},ref:E,gl:{preserveDrawingBuffer:!0},style:{height:"100%",width:"100%"}},r.a.createElement(n.Suspense,{fallback:r.a.createElement(R,null)},r.a.createElement("group",{name:"sun",position:[500,900,0]},r.a.createElement("ambientLight",{intensity:.2})),r.a.createElement("group",{name:"sun",position:[50,0,0]},r.a.createElement("spotLight",{intensity:i/50})),r.a.createElement("group",{name:"sun",position:[-50,0,0]},r.a.createElement("spotLight",{intensity:c/50})),r.a.createElement("group",{name:"sun",position:[0,50,0]},r.a.createElement("spotLight",{intensity:s/50})),r.a.createElement("group",{name:"sun",position:[0,-50,0]},r.a.createElement("spotLight",{intensity:u/50})),r.a.createElement("group",{name:"sun",position:[0,0,50]},r.a.createElement("spotLight",{intensity:d/50})),r.a.createElement("group",{name:"sun",position:[0,0,-50]},r.a.createElement("spotLight",{intensity:m/50})),r.a.createElement("group",{position:[0,-20,0]},y&&r.a.createElement(_,null)),r.a.createElement("group",{position:[0,-8,0]},r.a.createElement(I,{activeColor:t,sprayMode:a,gltfIn:o,markings:p,armourColor:null,shading:!1,paint:b,setTargetA:w,targetA:O,buttons:["ScreenTwo","ScreenThree003"]}))),r.a.createElement(L,{target:O,setTargetA:w,rotate:g})))))}var W,F,q,$=Object(c.f)((function(e){var t=e.gltf,a=e.js,o=e.gameId,i=e.box,c=e.back,s=e.game,u=e.login,d=e.history,m=e.profilePriority,p=e.modelArtist,g=e.controls,b=e.rotate,f=e.paint,h=e.cameraPos,y=e.targets,x=e.watermark,O=Object(n.useRef)({}),w=r.a.useState(null),E=Object(l.a)(w,2),k=E[0],I=E[1],S=r.a.useState(0),C=Object(l.a)(S,2),B=C[0],P=C[1],z=r.a.useState(null),T=Object(l.a)(z,2),A=T[0],M=T[1],D={};return Object(n.useEffect)((function(){!A&&M(D)}),[D,A,O,a]),r.a.createElement(v,{h:"100%",w:"100%"},r.a.createElement(j,{h:"100%",w:"100%",j:"flex-start",a:"flex-start"},r.a.createElement(N,{activeColor:{color:"#fff",name:"Plastic Grey"},sprayMode:!1,gltfIn:t,gameId:o,modelName:s,paintMode:B,setPaintMode:P,lightOne:30,lightTwo:30,lightThree:0,lightFour:30,lightFive:0,lightSix:0,lightSeven:0,box:i,setPanels:I,panels:k,back:c,login:u,history:d,markings:null,profilePriority:m,modelArtist:p||null,rotate:b,controls:g,paint:f,cameraPos:h,targets:y,watermark:x})))})),G=a(71),J=["basic","modelId","controls","rotate","paint","cameraPos","targets","url","userId"],V=Object(G.a)(W||(W=Object(p.a)(["\n  query gameById($_id: MongoID!) {\n    gameById(_id: $_id) {\n      _id\n      name\n      summary\n      featureImage\n      gltf\n      bin\n      js\n      url\n      price\n      artistLink\n      artistName\n      whereToBuyLink\n      user {\n        _id\n        name\n        profileImg\n      }\n    }\n  }\n"]))),U=Object(G.a)(F||(F=Object(p.a)(["\n  query savedGameById($_id: MongoID!) {\n    savedGameById(_id: $_id) {\n      saveDataColors\n    }\n  }\n"]))),H=Object(G.a)(q||(q=Object(p.a)(["\n  query userById($_id: MongoID!) {\n    userById(_id: $_id) {\n      priority\n      name\n    }\n  }\n"])));function Z(e){e.basic;var t=e.modelId,a=e.controls,o=e.rotate,i=e.paint,c=e.cameraPos,s=e.targets,u=e.url,d=e.userId,p=Object(m.a)(e,J),b=r.a.useState(null),f=Object(l.a)(b,2),h=f[0],y=f[1],v=r.a.useState(null),j=Object(l.a)(v,2),x=j[0],O=j[1],w=r.a.useState(null),E=Object(l.a)(w,2),k=E[0],I=E[1],S=r.a.useState(null),C=Object(l.a)(S,2),B=C[0],P=C[1];return Object(n.useEffect)((function(){I(t)}),[t]),r.a.createElement("div",{style:{height:"100%",width:"100%"},onClick:function(){return i=null}},r.a.createElement("div",{style:{height:"100%",width:"100%"}},(h||u)&&r.a.createElement($,{gltf:u||h.gltf,js:u?"Model":h.js,parts:null,gameId:u?null:h._id,box:null,game:u?{}:h,login:!0,history:p.history,controls:a,rotate:o,cameraPos:c,paint:x,targets:s,watermark:!(B&&(!B||0===B.priority)),modelArtist:u?{}:{name:h.artistName,link:h.artistLink,buyLink:h.whereToBuyLink}})),!B&&d&&h&&r.a.createElement(g.a,{query:H,variables:{_id:d},fetchPolicy:"network-only",onCompleted:function(e){P(e.userById)}},(function(e){e.data;return null})),i&&h&&!x&&r.a.createElement(g.a,{query:U,variables:{_id:i},fetchPolicy:"network-only",onCompleted:function(e){O(e.savedGameById.saveDataColors)}},(function(e){e.data;return null})),i&&h&&!x&&r.a.createElement(g.a,{query:U,variables:{_id:i},fetchPolicy:"network-only",onCompleted:function(e){O(e.savedGameById.saveDataColors)}},(function(e){e.data;return null})),!h&&!u&&r.a.createElement(g.a,{query:V,variables:{_id:k},fetchPolicy:"network-only",onCompleted:function(e){return y(e.gameById)}},(function(e){e.data;return e.error?"Please visit http://minipainter3d.herokuapp.com":null})))}function K(e){var t=e.theme,a=e.modelId,n=e.controls,o=e.rotate,i=e.paint,l=e.cameraPos,s=e.targets,u=e.url,d=e.userId;Object.assign({},e.props);return r.a.createElement(c.c,null,r.a.createElement(c.a,{path:"/",render:function(e){return r.a.createElement(Z,Object.assign({},e,{theme:t,basic:!0,modelId:a,controls:n,rotate:o,paint:i,cameraPos:l,targets:s,url:u,userId:d}))}}))}for(var Q=Object(c.f)((function(e){var t=new s.a({uri:"https://minipainter3d-api.herokuapp.com/graphql",cache:new u.a({addTypename:!1}),headers:{authorization:""}}),a=r.a.useState(null),o=Object(l.a)(a,2),i=o[0],c=o[1],m=r.a.useState("blank"),p=Object(l.a)(m,2),g=p[0],b=p[1],f=r.a.useState("blank"),h=Object(l.a)(f,2),y=h[0],v=h[1],j=r.a.useState("blank"),x=Object(l.a)(j,2),O=x[0],w=x[1],E=r.a.useState("blank"),k=Object(l.a)(E,2),I=k[0],S=k[1],C=r.a.useState("blank"),B=Object(l.a)(C,2),P=B[0],z=B[1],T=r.a.useState(null),A=Object(l.a)(T,2),M=A[0],D=A[1],L=r.a.useState(null),R=Object(l.a)(L,2),_=R[0],N=R[1];return Object(n.useEffect)((function(){var t=document.getElementById(e.elementId);if(t){var a=t.getAttribute("userId"),n=t.getAttribute("camera").split(",");!i&&c(t.getAttribute("modelId")),"blank"===g&&b(t.getAttribute("controls")),"blank"===y&&v(t.getAttribute("rotate")),"blank"===O&&w(t.getAttribute("paint")),!M&&D(t.getAttribute("url")),a&&!_&&N(a),z(t.getAttribute("targets")),"blank"===I&&S([n[0],n[1],n[2]])}}),[i,I,g,O,e,y,M,_]),r.a.createElement("div",{style:{width:"100%",height:"100%"}},r.a.createElement(d.a,{client:t},i?r.a.createElement(K,{props:e,theme:null,modelId:i,controls:g,rotate:y,paint:O,cameraPos:I,targets:P,url:M,userId:_}):'Please add this to your site: <div id="modelId" modelId="6259ae1fb012e3b1d9746402"></div>'))})),X=a(49),Y=[],ee=document.getElementsByTagName("div"),te=0;te<ee.length;te++)ee[te].id.indexOf("modelId")>-1&&Y.push(ee[te].id);Y.map((function(e){return i.a.render(r.a.createElement(X.a,null,r.a.createElement(Q,{elementId:e})),document.getElementById(e))}))}},[[102,1,2]]]);
//# sourceMappingURL=main.02ad2f1e.chunk.js.map